FROM python:3.7-alpine

RUN apk update && apk add libpq
RUN apk add --virtual .build-deps \
      g++ \
      gcc \
      python3-dev \
      musl-dev \
      postgresql-dev \
      libxml2 \
      libxml2-dev && \
    apk add libxslt-dev

COPY test-requirements.txt /
RUN pip install -r /test-requirements.txt
COPY requirements.txt /
RUN pip install -r /requirements.txt
RUN apk del .build-deps

COPY run_tests.sh /run_tests.sh
VOLUME /src
WORKDIR /src

ENV FLASK_APP=aveslog
